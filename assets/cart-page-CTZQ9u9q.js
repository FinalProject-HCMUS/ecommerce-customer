import{j as e,r as p,u as k}from"./index-DN215bWz.js";import{B as q}from"./Breadcrumb-CsjvyBdt.js";import{d as N,L as S,a as t}from"./App-pOKgdu9_.js";import{f as u,u as z}from"./string-Bxnaa8DJ.js";import{L as D}from"./Loading-DkqDsTGE.js";import{a as h,s as b}from"./request-dXeyi40M.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=N("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=N("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),T=({quantity:s,onDecrease:l,onIncrease:c})=>e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-full",children:[e.jsx("button",{onClick:l,className:"w-8 h-8 flex items-center justify-center rounded-l-full hover:bg-gray-100",children:"âˆ’"}),e.jsx("span",{className:"w-8 text-center",children:s}),e.jsx("button",{onClick:c,className:"w-8 h-8 flex items-center justify-center rounded-r-full hover:bg-gray-100",children:"+"})]}),V=({item:s,updateQuantity:l,removeItem:c})=>e.jsx("div",{className:"bg-white rounded-[12px] p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-20 w-20 flex-shrink-0 overflow-hidden rounded-[12px] border border-gray-200",children:e.jsx("img",{src:s.product.mainImageUrl,className:"h-full w-full object-cover object-center"})}),e.jsx("div",{className:"ml-4 flex-1",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{to:`/product/${s.product.id}`,className:"text-lg font-medium text-gray-900 hover:text-blue-600",children:s.product.name}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:`${t("lbl.size")}: ${s.size}`}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:[t("lbl.color"),":"," ",e.jsx("button",{style:{backgroundColor:s.color},className:"w-3 h-3 rounded-full transition-transform duration-200 hover:scale-105 py-1"})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("button",{onClick:()=>c(s.id),className:"text-red-500 hover:text-red-70",children:e.jsx(R,{size:18})}),e.jsx("div",{className:"flex flex-end mt-4",children:e.jsx(T,{quantity:s.quantity,onDecrease:()=>l(s.id,s.quantity-1),onIncrease:()=>l(s.id,s.quantity+1)})})]})]})})]})}),E=({data:s})=>{const{subtotal:l,deliveryFee:c,total:i}=s;return e.jsxs("div",{className:"bg-white rounded-[12px] p-6 border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:t("lbl.orderSummary")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:t("lbl.subTotal")}),e.jsx("span",{className:"font-medium",children:u(l,"VND")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:t("lbl.deliveryFee")}),e.jsx("span",{className:"font-medium",children:u(c,"VND")})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4 mt-4",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-lg font-medium",children:t("lbl.total")}),e.jsx("span",{className:"text-lg font-bold",children:u(i,"VND")})]})}),e.jsxs("button",{className:"w-full bg-black text-white py-4 px-6 rounded-full mt-6 flex items-center justify-center",children:[e.jsx("span",{children:t("lbl.gotoCheckout")}),e.jsx(L,{className:"ml-2",size:18})]})]})]})};function H(){const{loading:s,fetchCartItemsByUserId:l,removeCartItem:c,modifyCartItem:i}=z(),[o,x]=p.useState([]),{userInfo:d}=k(a=>a.auth);p.useEffect(()=>{(async()=>{const r=d==null?void 0:d.id;if(!r)return;const n=await l(r);n&&x(n)})()},[]);const g=async(a,r)=>{if(r<1){h(t("error.invalidQuantity"));return}const n={quantity:r,userId:d==null?void 0:d.id,itemId:a};await i(a,n)?(x(I=>I.map(m=>m.id===a?{...m,quantity:r}:m)),b(t("success.cartUpdated"))):h(t("error.cartUpdateFailed"))},v=async a=>{await c(a)?(x(n=>n.filter(y=>y.id!==a)),b(t("success.itemRemoved"))):h(t("error.failedToRemoveItem"))};if(s)return e.jsx(D,{});const f=o.reduce((a,r)=>a+(r==null?void 0:r.product.price)*(100-(r==null?void 0:r.product.discountPercent))*r.quantity,0),j=3e4,w=f+j,C={subtotal:f,deliveryFee:j,total:w};return e.jsxs("div",{className:"max-w-7xl mx-auto mt-10 mx-8 px-4 py-8",children:[e.jsx(q,{items:[{label:t("breadcrumb.home"),path:"/"},{label:t("breadcrumb.cart"),path:"/cart"}]}),e.jsx("h1",{className:"text-xl font-bold mb-8",children:t("lbl.yourCart")}),o.length===0&&e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:t("lbl.emptyCart")}),e.jsx("p",{className:"mt-2 text-gray-600",children:t("lbl.addItemsToCart")})]}),o.length>0&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-4",children:o.map(a=>e.jsx(V,{item:a,updateQuantity:g,removeItem:v},a.id))}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(E,{data:C})})]})]})}export{H as default};
