import{j as e,r as y,u as D}from"./index-D05w7RTC.js";import{B as F}from"./Breadcrumb-DFXllJyQ.js";import{d as I,L as R,a as l,I as T}from"./App-4Od_FrKz.js";import{f as g}from"./string-msUNxrnf.js";import{u as $}from"./cart-NTM_YuEt.js";import{L as E}from"./Loading-DCK6rVum.js";import{a as N,s as w}from"./request-B_Pa-C8s.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=I("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=I("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),B=({quantity:t,onDecrease:n,onIncrease:o})=>e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-full",children:[e.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-l-full hover:bg-gray-100",children:"−"}),e.jsx("span",{className:"w-8 text-center",children:t}),e.jsx("button",{onClick:o,className:"w-8 h-8 flex items-center justify-center rounded-r-full hover:bg-gray-100",children:"+"})]}),P=({item:t,updateQuantity:n,removeItem:o,isSelected:x,onSelect:u})=>e.jsx("div",{className:"bg-white rounded-[12px] p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center mr-4",children:e.jsx("input",{type:"checkbox",id:`item-${t.id}`,checked:x,onChange:r=>u(t.id,r.target.checked),className:"h-5 w-5 text-blue-600 rounded focus:ring-blue-500","aria-label":`Select ${t.product.name} for checkout`})}),e.jsx("div",{className:"h-20 w-20 flex-shrink-0 overflow-hidden rounded-[12px] border border-gray-200",children:e.jsx("img",{src:t.product.mainImageUrl,className:"h-full w-full object-cover object-center",alt:t.product.name})}),e.jsx("div",{className:"ml-4 flex-1",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx(R,{to:`/product/${t.product.id}`,className:"text-lg font-medium text-gray-900 hover:text-blue-600",children:t.product.name}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:`${l("lbl.size")}: ${t.size}`}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:[l("lbl.color"),":"," ",e.jsx("button",{style:{backgroundColor:t.color},className:"w-3 h-3 rounded-full transition-transform duration-200 hover:scale-105 py-1"})]}),e.jsxs("p",{className:"mt-2 text-md font-medium text-gray-900",children:[(t.product.price*(100-t.product.discountPercent)/100).toLocaleString("vi-VN")," ","₫"]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("button",{onClick:()=>o(t.id),className:"text-red-500 hover:text-red-700",children:e.jsx(U,{size:18})}),e.jsx("div",{className:"flex flex-end mt-4",children:e.jsx(B,{quantity:t.quantity,onDecrease:()=>n(t.id,t.quantity-1),onIncrease:()=>n(t.id,t.quantity+1)})})]})]})})]})}),H=({data:t,isCheckoutEnabled:n=!0,onCheckout:o})=>{const{subtotal:x,deliveryFee:u,total:r,selectedItemCount:i,totalItemCount:c}=t;return e.jsxs("div",{className:"bg-white rounded-[12px] p-6 border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:l("lbl.orderSummary")}),i!==void 0&&c!==void 0&&e.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:[l("lbl.selectedItems"),": ",i,"/",c]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:l("lbl.subTotal")}),e.jsx("span",{className:"font-medium",children:g(x,"VND")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:l("lbl.deliveryFee")}),e.jsx("span",{className:"font-medium",children:g(u,"VND")})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4 mt-4",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-lg font-medium",children:l("lbl.total")}),e.jsx("span",{className:"text-lg font-bold",children:g(r,"VND")})]})}),e.jsxs("button",{className:"w-full bg-black text-white py-4 px-6 rounded-full mt-6 flex items-center justify-center",onClick:o,disabled:!n,style:n?{}:{opacity:.5,cursor:"not-allowed"},children:[e.jsx("span",{children:l("lbl.gotoCheckout")}),e.jsx(M,{className:"ml-2",size:18})]})]})]})};function Y(){const t=T(),{loading:n,fetchCartItemsByUserId:o,removeCartItem:x,modifyCartItem:u}=$(),[r,i]=y.useState([]),[c,h]=y.useState(new Set),{userInfo:m}=D(s=>s.auth);y.useEffect(()=>{(async()=>{const a=m==null?void 0:m.id;if(!a)return;const d=await o(a);d&&(i(d),h(new Set(d.map(f=>f.id))))})()},[]);const C=async(s,a)=>{if(a<1){N(l("error.invalidQuantity"));return}const d={quantity:a,userId:m==null?void 0:m.id,itemId:s};await u(s,d)?(i(V=>V.map(j=>j.id===s?{...j,quantity:a}:j)),w(l("success.cartUpdated"))):N(l("error.cartUpdateFailed"))},k=async s=>{if(await x(s)){if(i(d=>d.filter(f=>f.id!==s)),c.has(s)){const d=new Set(c);d.delete(s),h(d)}w(l("success.itemRemoved"))}else N(l("error.failedToRemoveItem"))},S=(s,a)=>{const d=new Set(c);a?d.add(s):d.delete(s),h(d)},z=s=>{s.target.checked?h(new Set(r.map(a=>a.id))):h(new Set)};if(n)return e.jsx(E,{});const q=()=>{const s=r.filter(a=>c.has(a.id));t("/checkout",{state:{selectedCartItems:s,orderSummary:{subtotal:p,deliveryFee:b,total:v}}})},p=r.filter(s=>c.has(s.id)).reduce((s,a)=>s+(a==null?void 0:a.product.price)*(100-(a==null?void 0:a.product.discountPercent))*a.quantity/100,0),b=c.size>0?3e4:0,v=p+b,A={subtotal:p,deliveryFee:b,total:v,selectedItemCount:c.size,totalItemCount:r.length},L=r.length>0&&c.size===r.length;return e.jsxs("div",{className:"max-w-7xl mx-auto mt-10 px-4 py-8",children:[e.jsx(F,{items:[{label:l("breadcrumb.home"),path:"/"},{label:l("breadcrumb.cart"),path:"/cart"}]}),e.jsx("h1",{className:"text-xl font-bold mb-8",children:l("lbl.yourCart")}),r.length===0&&e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:l("lbl.emptyCart")}),e.jsx("p",{className:"mt-2 text-gray-600",children:l("lbl.addItemsToCart")})]}),r.length>0&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{type:"checkbox",id:"select-all",checked:L,onChange:z,className:"h-5 w-5 text-blue-600 rounded focus:ring-blue-500 mr-2"}),e.jsxs("label",{htmlFor:"select-all",className:"text-sm font-medium",children:[l("lbl.selectAll")," (",c.size,"/",r.length,")"]})]}),r.map(s=>e.jsx(P,{item:s,updateQuantity:C,removeItem:k,isSelected:c.has(s.id),onSelect:S},s.id))]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(H,{data:A,isCheckoutEnabled:c.size>0,onCheckout:q})})]})]})}export{Y as default};
