import{j as e,t as l,k as S,r as N,u as M,i as v,h as I}from"./index-YT-tQ_yZ.js";import{B as U}from"./Breadcrumb-CMmgObY6.js";import{c as z,L as V,E as B}from"./App-Cy2zvDKu.js";import{f as w}from"./string-msUNxrnf.js";import{u as D}from"./cart-e_BRE0Xu.js";import{L as P}from"./Loading-D2jcJrzf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=z("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=z("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),G=({quantity:s,onDecrease:o,onIncrease:i})=>e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-full",children:[e.jsx("button",{onClick:o,className:"w-8 h-8 flex items-center justify-center rounded-l-full hover:bg-gray-100",children:"−"}),e.jsx("span",{className:"w-8 text-center",children:s}),e.jsx("button",{onClick:i,className:"w-8 h-8 flex items-center justify-center rounded-r-full hover:bg-gray-100",children:"+"})]}),J=({item:s,updateQuantity:o,removeItem:i,isSelected:x,onSelect:h})=>e.jsx("div",{className:"bg-white rounded-[12px] p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center mr-4",children:e.jsx("input",{type:"checkbox",id:`item-${s.id}`,checked:x,onChange:r=>h(s.id,r.target.checked),className:"h-5 w-5 text-blue-600 rounded focus:ring-blue-500","aria-label":`Select ${s.product.name} for checkout`})}),e.jsx("div",{className:"h-20 w-20 flex-shrink-0 overflow-hidden rounded-[12px] border border-gray-200",children:e.jsx("img",{src:s.product.mainImageUrl,className:"h-full w-full object-cover object-center",alt:s.product.name})}),e.jsx("div",{className:"ml-4 flex-1",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx(V,{to:`/product/${s.product.id}`,className:"text-lg font-medium text-gray-900 hover:text-blue-600",children:s.product.name}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:`${l("lbl.size")}: ${s.size}`}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:[l("lbl.color"),":"," ",e.jsx("button",{style:{backgroundColor:s.color},className:"w-3 h-3 rounded-full transition-transform duration-200 hover:scale-105 py-1"})]}),e.jsxs("p",{className:"mt-2 text-md font-medium text-gray-900",children:[(s.product.price*(100-s.product.discountPercent)/100).toLocaleString("vi-VN")," ","₫"]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("button",{onClick:()=>i(s.id),className:"text-red-500 hover:text-red-700","data-testid":`remove-item-${s.id}`,children:e.jsx(O,{size:18})}),e.jsx("div",{className:"flex flex-end mt-4",children:e.jsx(G,{quantity:s.quantity,onDecrease:()=>o(s.id,s.quantity-1),onIncrease:()=>o(s.id,s.quantity+1)})})]})]})})]})}),K=({data:s,isCheckoutEnabled:o=!0,onCheckout:i})=>{var f;const{subtotal:x,deliveryFee:h,total:r,selectedItemCount:u,totalItemCount:c}=s,{settings:m}=S(),d=((f=m.find(y=>y.key==="CurrencyCode"))==null?void 0:f.value)||"VND";return e.jsxs("div",{className:"bg-white rounded-[12px] p-6 border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:l("lbl.orderSummary")}),u!==void 0&&c!==void 0&&e.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:[l("lbl.selectedItems"),": ",u,"/",c]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:l("lbl.subTotal")}),e.jsx("span",{className:"font-medium",children:w(x,d)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:l("lbl.deliveryFee")}),e.jsx("span",{className:"font-medium",children:w(h,d)})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4 mt-4",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-lg font-medium",children:l("lbl.total")}),e.jsx("span",{className:"text-lg font-bold",children:w(r,d)})]})}),e.jsxs("button",{className:"w-full bg-black text-white py-4 px-6 rounded-full mt-6 flex items-center justify-center",onClick:i,disabled:!o,style:o?{}:{opacity:.5,cursor:"not-allowed"},children:[e.jsx("span",{children:l("lbl.gotoCheckout")}),e.jsx(H,{className:"ml-2",size:18})]})]})]})};function ee(){var k;const s=B(),{loading:o,fetchCartItemsByUserId:i,removeCartItem:x,modifyCartItem:h}=D(),[r,u]=N.useState([]),[c,m]=N.useState(new Set),{userInfo:d}=M(t=>t.auth),{settings:f}=S(),y=((k=f.find(t=>t.key==="ShippingPrice"))==null?void 0:k.value)||0;N.useEffect(()=>{(async()=>{const a=d==null?void 0:d.id;if(!a)return;const n=await i(a);n&&(u(n),m(new Set(n.map(p=>p.id))))})()},[]);const q=async(t,a)=>{if(a<1){v(l("error.invalidQuantity"));return}const n={quantity:a,userId:d==null?void 0:d.id,itemId:t};await h(t,n)?(u(T=>T.map(g=>g.id===t?{...g,quantity:a}:g)),I(l("success.cartUpdated"))):v(l("error.cartUpdateFailed"))},A=async t=>{if(await x(t)){if(u(n=>n.filter(p=>p.id!==t)),c.has(t)){const n=new Set(c);n.delete(t),m(n)}I(l("success.itemRemoved"))}else v(l("error.failedToRemoveItem"))},F=(t,a)=>{const n=new Set(c);a?n.add(t):n.delete(t),m(n)},L=t=>{t.target.checked?m(new Set(r.map(a=>a.id))):m(new Set)};if(o)return e.jsx(P,{});const $=()=>{const t=r.filter(a=>c.has(a.id));s("/checkout",{state:{selectedCartItems:t,orderSummary:{subtotal:b,deliveryFee:j,total:C}}})},b=r.filter(t=>c.has(t.id)).reduce((t,a)=>t+(a==null?void 0:a.product.price)*(100-(a==null?void 0:a.product.discountPercent))*a.quantity/100,0),j=c.size>0?y:0,C=b+j,E={subtotal:b,deliveryFee:j,total:C,selectedItemCount:c.size,totalItemCount:r.length},R=r.length>0&&c.size===r.length;return e.jsxs("div",{className:"mx-auto mt-10 px-4 py-8",children:[e.jsx(U,{items:[{label:l("breadcrumb.home"),path:"/"},{label:l("breadcrumb.cart"),path:"/cart"}]}),e.jsx("h1",{className:"text-xl font-bold mb-8",children:l("lbl.yourCart")}),r.length===0&&e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:l("lbl.emptyCart")}),e.jsx("p",{className:"mt-2 text-gray-600",children:l("lbl.addItemsToCart")})]}),r.length>0&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{type:"checkbox",id:"select-all",checked:R,onChange:L,className:"h-5 w-5 text-blue-600 rounded focus:ring-blue-500 mr-2"}),e.jsxs("label",{htmlFor:"select-all",className:"text-sm font-medium",children:[l("lbl.selectAll")," (",c.size,"/",r.length,")"]})]}),r.map(t=>e.jsx(J,{item:t,updateQuantity:q,removeItem:A,isSelected:c.has(t.id),onSelect:F},t.id))]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(K,{data:E,isCheckoutEnabled:c.size>0,onCheckout:$})})]})]})}export{ee as default};
