import{r as s,j as e,u as q}from"./index-DN215bWz.js";import{B as $}from"./Breadcrumb-CsjvyBdt.js";import{R as V,C as F,S as O,Q,A as W,g as Y,u as G,a as J}from"./products-Dxc8Nz-6.js";import{f as z,u as H}from"./string-Bxnaa8DJ.js";import{d as K,a as x,B as f,C as L,J as X,M as Z}from"./App-pOKgdu9_.js";import{L as ee}from"./Loading-DkqDsTGE.js";import{d as te}from"./common-C2pIToax.js";import{a as T}from"./request-dXeyi40M.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=K("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),ae=({images:t})=>{var r;const[l,a]=s.useState(0);return e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex md:flex-col gap-2",children:t.map((n,d)=>e.jsx("img",{src:n.url,className:`w-16 h-16 object-cover cursor-pointer rounded-[12px] ${l===d?"border-2 border-blue-500":""}`,onClick:()=>a(d)},n.id))}),e.jsx("div",{className:"flex-1",children:e.jsx("img",{src:(r=t[l])==null?void 0:r.url,className:"w-full h-auto rounded-[12px]"})})]})},ie=({currentPrice:t,originalPrice:l,discountPercentage:a,size:r="md"})=>{const n={sm:{current:"text-base font-bold",original:"text-sm text-gray-400 line-through",discount:"text-xs text-red-500 bg-red-100 px-1.5 py-0.5 rounded"},md:{current:"text-xl font-bold",original:"text-base text-gray-400 line-through",discount:"text-xs text-red-500 bg-red-100 px-2 py-0.5 rounded"},lg:{current:"text-2xl font-bold",original:"text-xl text-gray-400 line-through",discount:"text-sm text-red-500 bg-red-100 px-2 py-0.5 rounded"}};return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:n[r].current,children:z(t,"VND")}),a!=0&&e.jsx("span",{className:n[r].original,children:z(l,"VND")}),a!=0&&e.jsxs("span",{className:n[r].discount,children:["-",a,"%"]})]})},re=({product:t,colors:l,productColorSize:a,sizes:r,handleAddToCart:n,isAdding:d})=>{const[o,b]=s.useState(""),[u,y]=s.useState(""),[g,c]=s.useState(""),[i,p]=s.useState(1),[h,j]=s.useState(t.total||0);s.useEffect(()=>{if(o&&u){const N=a.find(m=>m.color.id===o&&m.size.id===u);N?(c(N.id),j(N.quantity)):j(0)}else j(t.total||0)},[o,u,a,t.total]);const R=N=>{p(N==="increase"?m=>m<h?m+1:h:m=>m>1?m-1:1)};return e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h1",{className:"text-2xl font-bold",children:t.name}),e.jsx("span",{className:"text-xs font-semibold text-blue-800 bg-blue-100 px-4 py-1 rounded-full mt-1 inline-block",children:`${x("lbl.quantity")}: ${h}`}),e.jsx("span",{className:`text-xs font-semibold ${h>0?"text-green-800 bg-green-100":"text-red-800 bg-red-100"} px-4 py-1 rounded-full`,children:h>0?x("lbl.inStock"):x("lbl.outOfStock")})]}),e.jsx("div",{className:"flex items-center mb-4",children:e.jsx(V,{rating:t.averageRating})}),e.jsx("div",{className:"mb-4",children:e.jsx(ie,{currentPrice:t.price*(100-t.discountPercent)/100,originalPrice:t.price,discountPercentage:t.discountPercent,size:"lg"})}),e.jsx(F,{colors:l,selectedColor:o,onChange:b}),e.jsx(O,{sizes:r,selectedSize:u,onChange:y}),h>0&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Q,{quantity:i,onDecrement:()=>R("decrease"),onIncrement:()=>R("increase")}),e.jsx(W,{isAdding:d,onClick:()=>n(i,g)})]})]})},ne=()=>{const[t,l]=s.useState(null),[a,r]=s.useState(null),n=d=>{var b;const o=(b=d.target.files)==null?void 0:b[0];if(o){const u=new FileReader;u.onload=y=>{var c;const g=(c=y.target)==null?void 0:c.result;l(g),setTimeout(()=>{r(g)},1e3)},u.readAsDataURL(o)}};return e.jsxs("div",{className:"min-h-screen bg-white flex flex-col items-center px-4 py-8",children:[e.jsx(f.h1,{className:"text-4xl font-bold text-center mb-12",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:"Virtual Try On"}),e.jsxs("div",{className:"w-full max-w-7xl grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[e.jsx(f.div,{className:"bg-gray-100 rounded-lg aspect-square flex items-center justify-center overflow-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.1},children:t?e.jsx(f.img,{src:t,alt:"Uploaded",className:"w-full h-full object-contain",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3}}):null}),e.jsx(f.div,{className:"bg-gray-100 rounded-lg aspect-square flex items-center justify-center overflow-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},children:t&&!a?e.jsx(f.div,{className:"w-16 h-16 border-4 border-gray-300 border-t-gray-600 rounded-full",animate:{rotate:360},transition:{duration:1,repeat:Number.POSITIVE_INFINITY,ease:"linear"}}):t?e.jsx(f.img,{src:t,alt:"Processing",className:"w-full h-full object-contain opacity-50",initial:{opacity:0},animate:{opacity:.5},transition:{duration:.3}}):null}),e.jsxs(f.div,{className:"bg-gray-100 rounded-lg aspect-square flex items-center justify-center overflow-hidden relative",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.3},children:[e.jsx(L,{children:!t&&e.jsx(f.span,{className:"text-gray-400 text-lg",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:"Result"})}),e.jsx(L,{children:a&&e.jsx(f.img,{src:a,alt:"Result",className:"w-full h-full object-contain",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5}})})]})]}),e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:e.jsxs("label",{className:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 px-6 rounded-md cursor-pointer transition-colors duration-200",children:["Upload your image",e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:n})]})})]})},le=({description:t})=>e.jsxs("div",{className:"mt-16 mb-8",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:x("lbl.description")}),e.jsx("div",{className:"border border-gray-200 rounded-[12px] p-4",dangerouslySetInnerHTML:{__html:t}})]}),oe=({author:t,isVerified:l=!1,rating:a,content:r,date:n})=>e.jsxs("div",{className:"border border-gray-200 rounded-[12px] p-6 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:e.jsx(V,{rating:a})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium mr-2",children:t}),l&&e.jsx("span",{className:"bg-green-500 rounded-full w-4 h-4 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"âœ“"})})]})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:e.jsx(se,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-gray-700 my-3",children:r}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Posted on ",n]})]}),ce=[{id:1,author:"Samantha D.",isVerified:!0,rating:4.5,content:`"I absolutely love this t-shirt! The design is unique and the fabric feels so comfortable. As a fellow designer, I appreciate the attention to detail. It's become my favorite go-to shirt."`,date:"August 14, 2023"},{id:2,author:"John M.",isVerified:!1,rating:4,content:`"Great quality and fast shipping. The shirt fits perfectly, and I've received so many compliments on it!"`,date:"August 10, 2023"},{id:3,author:"Emily R.",isVerified:!0,rating:5,content:`"This is hands down the best purchase I've made this year. The material is soft, and the design is stunning!"`,date:"August 5, 2023"}],de=()=>{const[t,l]=s.useState(ce),[a,r]=s.useState(2),[n,d]=s.useState(!1),[o,b]=s.useState({author:"",rating:0,content:"",date:new Date().toLocaleDateString(),isVerified:!0}),u=()=>{r(i=>i+2)},y=()=>{d(i=>!i)},g=i=>{const{name:p,value:h}=i.target;b(j=>({...j,[p]:h}))},c=i=>{i.preventDefault(),l(p=>[{...o,id:Date.now()},...p]),b({author:"",rating:0,content:"",date:new Date().toLocaleDateString(),isVerified:!0}),d(!1)};return e.jsxs("div",{className:"mt-16 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold",children:[x("lbl.allReviews")," ",e.jsxs("span",{className:"text-gray-500 font-normal",children:["(",t.length,")"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-full px-3 py-1.5",children:[e.jsx("span",{className:"text-sm mr-2",children:x("lbl.lastest")}),e.jsx(X,{className:"h-4 w-4"})]}),e.jsx("button",{className:"bg-black text-white px-4 py-1.5 rounded-full text-sm hover:bg-gray-800 transition-colors",onClick:y,children:n?"Cancel":"Write a Review"})]})]}),n&&e.jsxs("form",{onSubmit:c,className:"mb-6 p-4 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"author",className:"block text-sm font-medium text-gray-700",children:"Your Name"}),e.jsx("input",{type:"text",id:"author",name:"author",value:o.author,onChange:g,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-black focus:border-black sm:text-sm",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"rating",className:"block text-sm font-medium text-gray-700",children:"Rating (1-5)"}),e.jsx("input",{type:"number",id:"rating",name:"rating",value:o.rating,onChange:g,min:"1",max:"5",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-black focus:border-black sm:text-sm",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700",children:"Your Review"}),e.jsx("textarea",{id:"content",name:"content",value:o.content,onChange:g,rows:4,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-black focus:border-black sm:text-sm",required:!0})]}),e.jsx("button",{type:"submit",className:"bg-black text-white px-4 py-2 rounded-full text-sm hover:bg-gray-800 transition-colors",children:"Submit Review"})]}),t.slice(0,a).map(i=>e.jsx(oe,{author:i.author,isVerified:i.isVerified,rating:i.rating,content:i.content,date:i.date},i.id)),a<t.length&&e.jsx("button",{className:"w-full py-3 border border-gray-300 rounded-[12px] text-gray-600 hover:bg-gray-50 transition-colors",onClick:u,children:"Load More Reviews"})]})},ue=()=>{const[t,l]=s.useState(!1);return{loading:t,fetchProductImages:async r=>{l(!0);try{return(await Y(r)).data||null}finally{l(!1)}}}},je=()=>{const{id:t}=Z(),{fetchProductById:l,loading:a}=G(),{loading:r,fetchProductImages:n}=ue(),{loading:d,fetchProductColorSizes:o}=J(),[b,u]=s.useState([]),[y,g]=s.useState([]),[c,i]=s.useState(),[p,h]=s.useState([]),[j,R]=s.useState([]),[N,m]=s.useState(!1),{userInfo:S}=q(v=>v.auth),E=q(v=>v.auth.isAuthenticated),{addCartItem:_}=H();s.useEffect(()=>{(async()=>{if(!t)return;const C=await l(t),P=await n(t),I=await o(t);if(I){R(I);const M=I.map(w=>w.color).filter((w,k,D)=>k===D.findIndex(A=>A.id===w.id)),U=I.map(w=>w.size).filter((w,k,D)=>k===D.findIndex(A=>A.id===w.id));u(M),g(U)}C&&i(C),P&&h(P)})()},[t]);const B=async(v,C)=>{if(!(S!=null&&S.id)||!E){T(x("error.loginRequired"));return}if(!v){T(x("error.quantityRequired"));return}if(C===""){T(x("error.itemRequired"));return}const P={userId:S==null?void 0:S.id,itemId:C,quantity:v};await _(P)&&(m(!0),setTimeout(()=>{m(!1)},te))};return a||r||d?e.jsx(ee,{}):e.jsxs("div",{className:"max-w-7xl mt-10 px-4 py-8 font-sans",children:[e.jsx($,{items:[{label:x("breadcrumb.home"),path:"/"},{label:x("breadcrumb.detailProduct"),path:"/product"}]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[p&&e.jsx(ae,{images:p}),c&&e.jsx(re,{product:c,colors:b,productColorSize:j,sizes:y,isAdding:N,handleAddToCart:B})]}),e.jsx(ne,{}),(c==null?void 0:c.description)&&e.jsx(le,{description:c.description}),e.jsx(de,{})]})};export{je as default};
